version: v1beta11

vars:
- name: K3D_CLUSTER_NAME
  question: cluster name for k3d
  default: "devspace"

commands:
- name: init
  command: |-
    devspace run reset-cluster
- name: reset-cluster
  command: |-
    devspace run delete-cluster
    devspace run create-cluster
- name: delete-cluster
  command: |-
    k3d cluster delete ${K3D_CLUSTER_NAME}
- name: create-cluster
  command: |-
    k3d cluster create ${K3D_CLUSTER_NAME}
    kubectl config use-context k3d-${K3D_CLUSTER_NAME}
    kubectl config set-context --current --namespace ${K3D_CLUSTER_NAME}
