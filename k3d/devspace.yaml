version: v1beta11

vars:
- name: K3D_CLUSTER_NAME
  value: "devspace"

commands:
- name: activate
  command: |-
    kubectl config use-context k3d-${K3D_CLUSTER_NAME}
    kubectl config set-context --current --namespace ${K3D_CLUSTER_NAME}
- name: init
  command: |-
    k3d cluster create ${K3D_CLUSTER_NAME} --agents 2
    devspace run activate
- name: purge
  command: |-
    k3d cluster delete ${K3D_CLUSTER_NAME}
